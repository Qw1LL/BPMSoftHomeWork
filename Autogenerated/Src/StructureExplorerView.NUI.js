define("StructureExplorerView", ["ext-base", "BPMSoft", "sandbox", "StructureExplorerViewResources"],
	function(Ext, BPMSoft, sandbox, resources) {

		var entitySchema;

		function getContainerConfig(id) {
			return {
				className: "BPMSoft.Container",
				items: [],
				id: id,
				selectors: {
					wrapEl: "#" + id
				}
			};
		}
		function getItemContainerConfig(id, index) {
			return {
				className: "BPMSoft.Container",
				items: [],
				id: id + index,
				selectors: {
					wrapEl: "#" + id + index
				},
				classes: {
					wrapClassName: ["itemContainer"]
				},
				styles: {
					wrapStyles: {
						margin: "18px 0px 0px " + (35 * index) + "px"
					}
				}
			};
		}
		function generateMainView(viewModelSchema) {
			entitySchema = viewModelSchema.entitySchema;
			var viewConfig = getContainerConfig("autoGeneratedContainer");
			var headerConfig = getContainerConfig("header");
			var utilsConfig = getContainerConfig("utils");
			var leftPanelConfig = getContainerConfig("autoGeneratedLeftContainer");
			var bottomPanelConfig = getContainerConfig("autoGeneratedBottomContainer");
			var mainPanelConfig = getContainerConfig("autoGeneratedMainContainer");
			var firstItemConfig = getContainerConfig("firstItemConfig");
			var buttonsConfig = [];
			headerConfig.items = [
				{
					className: "BPMSoft.Label",
					markerValue: resources.localizableStrings.HeaderCaption,
					caption: resources.localizableStrings.HeaderCaption,
					classes: {
						labelClass: ["header-name"]
					},
					width: "auto"
				},
				{
					className: "BPMSoft.Button",
					caption: "",
					style: BPMSoft.controls.ButtonEnums.style.TRANSPARENT,
					imageConfig: resources.localizableImages.CloseIcon,
					markerValue: "closeButton",
					classes: {
						wrapperClass: ["close-btn-user-class"]
					},
					click: {
						bindTo: "onCancelClick"
					}
				}
			];
			var buttonConfig = {
				className: "BPMSoft.Button",
				margin: "0px 10px 0px 0px"
			};
			var firstButtonConfig = {
				caption: resources.localizableStrings.SelectButtonText,
				style: BPMSoft.controls.ButtonEnums.style.ORANGE,
				click: {
					bindTo: "select"
				},
				markerValue: "select-button"
			};
			var cancelButton = Ext.apply({}, {
				style: BPMSoft.controls.ButtonEnums.style.DEFAULT,
				caption: resources.localizableStrings.CancelButtonText,
				click: {
					bindTo: "onCancelClick"
				},
				markerValue: "cancel-button"
			}, buttonConfig);
			buttonsConfig.push(Ext.apply({}, firstButtonConfig, buttonConfig));
			buttonsConfig.push(cancelButton);
			utilsConfig.items = [
				{
					className: "BPMSoft.Container",
					id: "utils-left",
					selectors: {
						wrapEl: "#utils-left"
					},
					items: buttonsConfig
				}
			];
			firstItemConfig.items = [{
				className: "BPMSoft.Container",
				id: "RootEntityContainer",
				selectors: {
					wrapEl: "#RootEntityContainer"
				},
				items: [{
					className: "BPMSoft.Container",
					id: "itemButtonsContainer",
					selectors: {
						wrapEl: "#itemButtonsContainer"
					},
					items: [{
						className: "BPMSoft.Button",
						visible: {
							bindTo: "ExpandVisible"
						},
						click: {
							bindTo: "expand"
						},
						markerValue: "addObject",
						imageConfig: resources.localizableImages.ExpandImage,
						style: BPMSoft.controls.ButtonEnums.style.TRANSPARENT
					}, {
						className: "BPMSoft.Button",
						visible: {
							bindTo: "RemoveVisible"
						},
						click: {
							bindTo: "close"
						},
						imageConfig: resources.localizableImages.CloseImage,
						style: BPMSoft.controls.ButtonEnums.style.TRANSPARENT
					}]
				}, {
					className: "BPMSoft.Label",
					caption: {
						bindTo: "caption"
					},
					classes: {
						labelClass: ["object-name"]
					},
					width: "auto"
				}]
			}];
			leftPanelConfig.items = [];

			bottomPanelConfig.items = [
				{
					className: "BPMSoft.Label",
					caption: resources.localizableStrings.ItemsName
				}, {
					className: "BPMSoft.ComboBoxEdit",
					enabled: {
						bindTo: "ComboBoxListEnabled"
					},
					id: "itemComboBox",
					selectors: {
						wrapEl: "#itemComboBox"
					},
					keydown: {
						bindTo: "onKeyDown"
					},
					isRequired: true,
					value: {
						bindTo: "EntitySchemaColumn"
					},
					list: {
						bindTo: "EntitySchemaColumnList"
					},
					placeholder: resources.localizableStrings.ItemsPlaceHolder,
					prepareList: {
						bindTo: "getItems"
					},
					markerValue: resources.localizableStrings.ItemsName
				}
			];
			mainPanelConfig.items = [leftPanelConfig, bottomPanelConfig];
			viewConfig.items = [headerConfig, firstItemConfig, mainPanelConfig, utilsConfig];
			return viewConfig;
		}
		function generateItemView(viewModelSchema, index) {
			entitySchema = viewModelSchema.entitySchema;
			var viewConfig = getItemContainerConfig("autoGeneratedContainer", index);
			viewConfig.items = [
				{
					className: "BPMSoft.Container",
					id: "itemButtonsContainer" + index,
					classes: {
						wrapClassName: ["expandCloseButtonsContainer"]
					},
					selectors: {
						wrapEl: "#itemButtonsContainer" + index
					},
					items: [{
						className: "BPMSoft.Button",
						tag: "ButtonExpand",
						enabled: {
							bindTo: "ExpandEnable"
						},
						visible: {
							bindTo: "ExpandVisible"
						},
						click: {
							bindTo: "expand"
						},
						imageConfig: resources.localizableImages.ExpandImage,
						style: BPMSoft.controls.ButtonEnums.style.TRANSPARENT

					}, {
						className: "BPMSoft.Button",
						tag: "ButtonClose",
						enabled: true,
						visible: {
							bindTo: "RemoveVisible"
						},
						click: {
							bindTo: "close"
						},
						imageConfig: resources.localizableImages.CloseImage,
						style: BPMSoft.controls.ButtonEnums.style.TRANSPARENT
					}]
				}, {
					className: "BPMSoft.Button",
					tag: "ButtonRemove",
					enabled: true,
					visible: {
						bindTo: "CloseVisible"
					},
					click: {
						bindTo: "remove"
					},
					classes: {
						wrapperClass: ["removeButton"]
					},
					imageConfig: resources.localizableImages.DeleteImage,
					style: BPMSoft.controls.ButtonEnums.style.TRANSPARENT
				}, {
					className: "BPMSoft.Container",
					id: "elementContainer" + index,
					classes: {
						wrapClassName: ["elementContainer"]
					},
					selectors: {
						wrapEl: "#elementContainer" + index
					},
					items: {
						id: "schemaLookup" + index,
						className: "BPMSoft.ComboBoxEdit",
						enabled: {
							bindTo: "ComboBoxListEnabled"
						},
						visible: true,
						isRequired: true,
						readonly: false,
						value: {
							bindTo: "EntitySchemaColumn"
						},
						list: {
							bindTo: "EntitySchemaColumnList"
						},
						prepareList: {
							bindTo: "getItems"
						},
						change: {
							bindTo: "ComboBoxListChange"
						},
						classes: {
							wrapClass: ["itemCombobox"]
						},
						placeholder: resources.localizableStrings.ElementsPlaceHolder,
						markerValue: "EntitySchema"
					}
				}
			];
			return viewConfig;
		}
		return {
			generateMainView: generateMainView,
			generateItemView: generateItemView
		};
	});
